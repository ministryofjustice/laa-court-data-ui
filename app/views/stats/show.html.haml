= govuk_page_heading(t('stats.show.title'))

= link_to t('stats.show.change_period'), new_stats_path, class: 'govuk-link'

.govuk-grid-row
  .govuk-grid-column-two-thirds
    %h2.govuk-heading-l{ class: 'govuk-!-margin-top-5 ' }
      = t('stats.show.current_period')
    %table.govuk-table{ class: "govuk-!-margin-bottom-4" }
      %caption.govuk-table__caption.govuk-visually-hidden
        = t('stats.show.caption')
      %tbody.govuk-table__body
        %tr.govuk-table__row
          %th.govuk-table__header{ scope: 'row' }
            = t('stats.show.date_from')
          %td.govuk-table__cell
            = @collection.current_range.date_from.to_date.to_fs(:human_readable)
        %tr.govuk-table__row
          %th.govuk-table__header{ scope: 'row' }
            = t('stats.show.date_to')
          %td.govuk-table__cell
            = @collection.current_range.date_to.to_date.to_fs(:human_readable)
        %tr.govuk-table__row
          %th.govuk-table__header{ scope: 'row' }
            = t('stats.show.linked')
          %td.govuk-table__cell
            = @collection.current_range.linked
        %tr.govuk-table__row
          %th.govuk-table__header{ scope: 'row' }
            = t('stats.show.unlinked')
          %td.govuk-table__cell
            = @collection.current_range.unlinked
        %tr.govuk-table__row
          %th.govuk-table__header{ scope: 'row' }
            = t('stats.show.unlink_reason_types')
          %td.govuk-table__cell
            - @collection.unlink_reason_types.each do |reason, total|
              %div
                #{reason}: #{total}
        %tr.govuk-table__row
          %th.govuk-table__header{ scope: 'row' }
            = t('stats.show.other_reasons_given')
          %td.govuk-table__cell
            - @collection.current_range.other_unlink_reasons.each do |reason|
              %div
                = reason

.govuk-grid-row
  .govuk-grid-column-two-thirds
    %h2.govuk-heading-l{ class: 'govuk-!-margin-top-5 ' }
      = t('stats.show.previous_periods')
    %table.govuk-table{ class: "govuk-!-margin-bottom-4" }
      %caption.govuk-table__caption.govuk-visually-hidden
        = t('stats.show.previous_ranges.caption')
      %thead.govuk-table__head
        %tr.govuk-table__row
          %th.govuk-table__header{ scope: 'col', class: 'govuk-!-width-one-quarter' }= t('stats.show.previous_ranges.from')
          %th.govuk-table__header{ scope: 'col', class: 'govuk-!-width-one-quarter' }= t('stats.show.previous_ranges.to')
          %th.govuk-table__header{ scope: 'col', class: 'govuk-!-width-one-quarter' }= t('stats.show.previous_ranges.linked')
          %th.govuk-table__header{ scope: 'col', class: 'govuk-!-width-one-quarter' }= t('stats.show.previous_ranges.unlinked')
      %tbody.govuk-table__body
        - @collection.previous_ranges.each do |range|
          %tr.govuk-table__row
            %td.govuk-table__cell
              = range.date_from.to_date.to_fs(:human_readable)
            %td.govuk-table__cell
              = range.date_to.to_date.to_fs(:human_readable)
            %td.govuk-table__cell
              = range.linked
            %td.govuk-table__cell
              = range.unlinked
